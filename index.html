<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>HBReader</title>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged, sendEmailVerification, sendPasswordResetEmail, GoogleAuthProvider, signInWithPopup, deleteUser } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, doc, setDoc, getDoc, collection, query, orderBy, getDocs, deleteDoc, updateDoc, increment, serverTimestamp, writeBatch, where, limit } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyADQMMGw1DXiUiNPBqnMcJh6iNdSrOZpTE",
            authDomain: "hbreader-928fa.firebaseapp.com",
            projectId: "hbreader-928fa",
            storageBucket: "hbreader-928fa.firebasestorage.app",
            messagingSenderId: "517240144248",
            appId: "1:517240144248:web:657ef8126811aa58ad888d",
            measurementId: "G-0QDCTRN7CL"
        };

        const app = initializeApp(firebaseConfig);
        window.firebaseAuth = getAuth(app);
        window.firebaseDb = getFirestore(app);
        window.firebaseAuthFunctions = { createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged, sendEmailVerification, sendPasswordResetEmail, GoogleAuthProvider, signInWithPopup, deleteUser };
        window.firebaseDbFunctions = { doc, setDoc, getDoc, collection, query, orderBy, getDocs, deleteDoc, updateDoc, increment, serverTimestamp, writeBatch, where, limit };
    </script>

    <link rel="stylesheet" href="src/styles/main.css">
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div style="display: flex; align-items: center; gap: 30px;">
                <div class="site-title" onclick="navigateTo('practice')" style="cursor: pointer;"><span style="color: var(--primary-blue);">HB</span>Reader</div>
                <nav class="nav-tabs" id="navTabs">
                    <button class="nav-tab active" onclick="navigateTo('practice')">Practice</button>
                    <button class="nav-tab" onclick="navigateTo('dashboard')">Dashboard</button>
                    <button class="nav-tab" onclick="navigateTo('history')">Question History</button>
                    <button class="nav-tab" onclick="navigateTo('leaderboard')">Leaderboard</button>
                    <button class="nav-tab" onclick="navigateTo('profile')">Profile</button>
                </nav>
            </div>
            <div id="userAuth">
                <button class="btn-login" onclick="showAuthModal()">Login / Sign Up</button>
            </div>
        </div>
    </div>

    <!-- Email Verification Banner -->
    <div id="verificationBanner" class="verification-banner">
        <strong>Email not verified.</strong> Please check your inbox and click the verification link.
        <button onclick="resendVerificationEmail()">Resend Email</button>
        <button onclick="checkVerificationStatus()">Close</button>
    </div>

    <!-- Practice Page Container -->
    <div id="practiceContainer" class="practice-container active">
    <!-- Profile Warning Banner -->
    <div id="profileWarningBanner" class="profile-warning" style="display: none;">
        <div class="profile-warning-icon">‚ö†Ô∏è</div>
        <div class="profile-warning-text">
            <strong>Set up your profile to appear on the leaderboard!</strong>
            <a class="profile-warning-link" onclick="navigateTo('profile')">Go to Profile</a>
        </div>
        <button class="profile-warning-dismiss" onclick="dismissProfileWarning()">‚úï</button>
    </div>

    <!-- Main Layout -->
    <div class="main-layout">
        <!-- Play Area (Left Side) -->
        <div class="play-area">
            <!-- Difficulty Indicator -->
            <div class="difficulty-indicator" id="difficultyIndicator">
                <span class="difficulty-label">Difficulty:</span>
                <span class="difficulty-value" id="difficultyValue"></span>
            </div>

            <!-- Selected Region Display -->
            <div class="question-types-indicator" id="regionIndicator" style="display: none;">
                <span class="question-types-label">Region:</span>
                <span class="question-types-tags" id="regionTags"></span>
            </div>

            <!-- Selected Time Period Display -->
            <div class="question-types-indicator" id="timePeriodIndicator" style="display: none;">
                <span class="question-types-label">Time Period:</span>
                <span class="question-types-tags" id="timePeriodTags"></span>
            </div>

            <!-- Selected Question Types Display -->
            <div class="question-types-indicator" id="questionTypesIndicator" style="display: none;">
                <span class="question-types-label">Types:</span>
                <span class="question-types-tags" id="questionTypesTags"></span>
            </div>

            <!-- Question Display -->
            <div class="question-display">
                <div class="question-text" id="questionText">
                    <div class="placeholder">
                        <strong>S</strong> start &nbsp;|&nbsp; <strong>SPACE</strong> buzz in &nbsp;|&nbsp; <strong>P</strong> pause/resume &nbsp;|&nbsp; <strong>N</strong> next
                    </div>
                </div>

                <div class="hint hidden" id="spacebarHint">
                    <strong>S</strong> start &nbsp;|&nbsp; <strong>SPACE</strong> buzz in &nbsp;|&nbsp; <strong>P</strong> pause/resume &nbsp;|&nbsp; <strong>N</strong> next
                </div>

                <!-- Buzzer Button (Mobile/Tablet) -->
                <button id="buzzerButton" class="buzzer-button" title="Tap to buzz in and answer">
                    TAP TO BUZZ IN
                </button>
            </div>

            <!-- Answer Section -->
            <div class="answer-section">
                <div class="answer-label">Answer</div>
                <div class="answer-text" id="answerText">
                    <span style="color: var(--text-tertiary); font-style: italic;">Answer will appear here</span>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="action-btn" id="startButton" onclick="handleStart()">Start</button>
                <button class="action-btn hidden" id="nextButton" onclick="handleNext()">Next</button>
                <button class="action-btn hidden" id="pauseButton" onclick="handlePauseResume()">Pause</button>
                <button class="action-btn" id="settingsButton" onclick="toggleSettings()">Settings</button>
            </div>

            <!-- Question History Section -->
            <div class="history-section">
                <div class="history-container">
                    <div class="history-title">Question History</div>
                    <div class="history-items" id="historyItems">
                        <span style="color: var(--text-tertiary); font-style: italic; font-size: 0.9em;">No questions practiced yet. Start practicing to see your history here.</span>
                    </div>
                </div>
            </div>

        </div>

        <!-- Settings Panel (Right Side) -->
        <div class="settings-panel" id="settingsPanel">
            <div class="settings-title">Settings</div>

            <!-- Question Set -->
            <div class="setting-group">
                <label for="questionSet">Question Set</label>
                <select id="questionSet">
                    <option value="nat_hist_bee">National History Bee</option>
                    <option value="us_hist_bee">US History Bee</option>
                </select>
            </div>

            <!-- Difficulty Level -->
            <div class="setting-group">
                <label for="category">Difficulty Level</label>
                <select id="category">
                    <option value="preliminary">Preliminary (3,573)</option>
                    <option value="quarterfinals">Quarterfinals (196)</option>
                    <option value="semifinals">Semifinals (365)</option>
                    <option value="finals">Finals (1,854)</option>
                </select>
            </div>

            <!-- Reading Speed -->
            <div class="setting-group">
                <label for="speed">Reading Speed</label>
                <input type="range" id="speed" min="10" max="100" value="50" step="10">
                <div class="speed-display">
                    <span id="speedLabel">Medium</span> (<span id="speedValue">50</span> ms/char)
                </div>
            </div>

            <!-- Font Size -->
            <div class="setting-group">
                <label for="fontSize">Font Size</label>
                <input type="range" id="fontSize" min="14" max="28" value="18" step="2">
                <div class="speed-display">
                    <span id="fontSizeLabel">Medium</span> (<span id="fontSizeValue">18</span>px)
                </div>
            </div>

            <!-- Answer Tolerance -->
            <div class="setting-group">
                <label for="answerTolerance">Answer Tolerance</label>
                <input type="range" id="answerTolerance" min="50" max="100" value="80" step="5">
                <div class="speed-display">
                    <span id="toleranceValue">80</span>% (forgives minor typos)
                </div>
                <div id="toleranceWarning" style="color: #e74c3c; font-size: 0.85em; margin-top: 5px; display: none;">
                    ‚ö†Ô∏è No XP earned below 80%
                </div>
            </div>

            <!-- Question Filters -->
            <div class="setting-group">
                <div class="setting-header">Question Filters</div>

                <!-- Region Filter -->
                <div id="regionFilterSection" class="filter-section">
                    <label>Region</label>
                    <select id="regionFilter" class="filter-select">
                        <option value="all">All Regions</option>
                        <option value="United States">United States</option>
                        <option value="Europe">Europe</option>
                        <option value="Asia">Asia</option>
                        <option value="Latin America & Caribbean">Latin America & Caribbean</option>
                        <option value="Americas (Pre-Columbian)">Americas (Pre-Columbian)</option>
                        <option value="Africa">Africa</option>
                        <option value="Middle East & North Africa">Middle East & North Africa</option>
                        <option value="Global/Multi-Regional">Global/Multi-Regional</option>
                    </select>
                </div>

                <!-- Time Period Filter -->
                <div id="timeFilterSection" class="filter-section">
                    <label>Time Period</label>
                    <select id="timeFilter" class="filter-select">
                        <option value="all">All Time Periods</option>
                        <option value="Ancient World (pre-500 CE)">Ancient World (pre-500 CE)</option>
                        <option value="Medieval Era (500-1450)">Medieval Era (500-1450)</option>
                        <option value="Early Modern (1450-1750)">Early Modern (1450-1750)</option>
                        <option value="Age of Revolutions (1750-1850)">Age of Revolutions (1750-1850)</option>
                        <option value="Industrial & Imperial Age (1850-1914)">Industrial & Imperial Age (1850-1914)</option>
                        <option value="World Wars & Interwar (1914-1945)">World Wars & Interwar (1914-1945)</option>
                        <option value="Contemporary Era (1945-present)">Contemporary Era (1945-present)</option>
                    </select>
                </div>

                <!-- Answer Type Filter -->
                <div class="filter-section">
                    <label>Question Type</label>
                    <select id="answerTypeFilter" class="filter-select">
                        <option value="all">All Types</option>
                        <option value="People & Biography">People & Biography</option>
                        <option value="Events (Wars, Battles, Revolutions)">Events (Wars, Battles, Revolutions)</option>
                        <option value="Political History & Diplomacy">Political History & Diplomacy</option>
                        <option value="Economic History & Trade">Economic History & Trade</option>
                        <option value="Social History & Daily Life">Social History & Daily Life</option>
                        <option value="Cultural History (Art, Literature, Music)">Cultural History (Art, Literature, Music)</option>
                        <option value="Religion & Mythology">Religion & Mythology</option>
                        <option value="Science, Technology & Innovation">Science, Technology & Innovation</option>
                        <option value="Geography & Environment">Geography & Environment</option>
                        <option value="Places, Cities & Civilizations">Places, Cities & Civilizations</option>
                        <option value="Groups, Organizations & Institutions">Groups, Organizations & Institutions</option>
                        <option value="Documents, Laws & Treaties">Documents, Laws & Treaties</option>
                        <option value="Ideas, Ideologies & Philosophies">Ideas, Ideologies & Philosophies</option>
                    </select>
                </div>

                <!-- Matching Questions Count -->
                <div id="matchingCount" class="matching-count" style="display: none;"></div>
            </div>

            <!-- Theme Toggle -->
            <div class="setting-group">
                <div class="setting-header">Appearance</div>
                <div class="theme-toggle-container" id="themeToggle">
                    <div class="theme-toggle-label">
                        <span class="theme-icon" id="themeIcon">‚òÄÔ∏è</span>
                        <span id="themeLabel">Light Mode</span>
                    </div>
                    <div class="toggle-switch" id="toggleSwitch">
                        <div class="toggle-slider"></div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Tooltip for history items -->
    <div class="history-tooltip" id="historyTooltip">
        <div class="tooltip-label">Question</div>
        <div class="tooltip-question" id="tooltipQuestion"></div>
        <div class="tooltip-label">Answer</div>
        <div class="tooltip-answer" id="tooltipAnswer"></div>
    </div>
    </div> <!-- End Practice Container -->

    <!-- Dashboard Container -->
    <div id="dashboardContainer" class="dashboard-container">
        <div class="dashboard-header">
            <h1 class="dashboard-title">Dashboard</h1>
            <div class="dashboard-question-set-selector">
                <label for="dashboardQuestionSet">Question Set:</label>
                <select id="dashboardQuestionSet">
                    <option value="all">All Question Sets</option>
                    <option value="nat_hist_bee">National History Bee</option>
                    <option value="us_hist_bee">US History Bee</option>
                </select>
            </div>
        </div>

        <!-- Overall Statistics -->
        <div class="dashboard-grid">
            <!-- Overall Accuracy Card -->
            <div class="dashboard-card">
                <div class="card-header">Overall Accuracy</div>
                <div class="card-body">
                    <div class="radial-chart" id="overallChart">
                        <!-- Chart will be generated by JS -->
                    </div>
                    <div class="stats-row">
                        <div class="stat-item">
                            <div class="stat-value correct" id="correctCount">0</div>
                            <div class="stat-label">Correct</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value incorrect" id="incorrectCount">0</div>
                            <div class="stat-label">Incorrect</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value skipped" id="skippedCount">0</div>
                            <div class="stat-label">Skipped</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Performance by Answer Type Card -->
            <div class="dashboard-card">
                <div class="card-header">Performance by Answer Type</div>
                <div class="card-body" style="align-items: stretch;">
                    <div id="answerTypeStats" class="category-stats">
                        <!-- Answer type stats will be generated by JS -->
                    </div>
                </div>
            </div>

            <!-- Performance by Difficulty -->
            <div class="dashboard-card">
                <div class="card-header">Performance by Difficulty</div>
                <div class="card-body">
                    <div class="difficulty-charts" id="difficultyCharts">
                        <!-- Difficulty charts will be generated by JS -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Performance Trends Section -->
        <div class="trends-section">
            <div class="trends-header">
                <div class="trends-title">Performance Trends</div>
                <div class="time-period-selector">
                    <button class="time-period-btn" data-period="today">Today</button>
                    <button class="time-period-btn" data-period="week">This Week</button>
                    <button class="time-period-btn active" data-period="month">This Month</button>
                    <button class="time-period-btn" data-period="year">This Year</button>
                    <button class="time-period-btn" data-period="all">All Time</button>
                </div>
            </div>

            <div class="trends-grid">
                <!-- Overall Accuracy Trend -->
                <div class="trend-card">
                    <div class="trend-card-header">Overall Accuracy Over Time</div>
                    <div class="trend-chart-container" id="overallTrendChart">
                        <!-- Chart will be generated by JS -->
                    </div>
                </div>

                <!-- Accuracy by Answer Type Trend -->
                <div class="trend-card">
                    <div class="trend-card-header">Accuracy by Answer Type</div>
                    <div class="trend-chart-container" id="answerTypeTrendChart">
                        <!-- Chart will be generated by JS -->
                    </div>
                    <div class="trend-legend" id="answerTypeTrendLegend"></div>
                </div>

                <!-- Accuracy by Difficulty Trend -->
                <div class="trend-card">
                    <div class="trend-card-header">Accuracy by Difficulty</div>
                    <div class="trend-chart-container" id="difficultyTrendChart">
                        <!-- Chart will be generated by JS -->
                    </div>
                    <div class="trend-legend" id="difficultyTrendLegend"></div>
                </div>
            </div>
        </div>

    </div>

    <!-- Question History Container -->
    <div id="historyContainer" class="dashboard-container">
        <div class="dashboard-header">
            <h1 class="dashboard-title">Question History</h1>
            <p class="dashboard-subtitle">Review your practice history and track your progress</p>
        </div>

        <div class="history-table-container">
            <div class="history-controls">
                <input type="text" class="history-search" id="historySearch" placeholder="Search by Question ID...">
                <select class="history-filter" id="historyQuestionSetFilter">
                    <option value="all">All Question Sets</option>
                    <option value="nat_hist_bee">National History Bee</option>
                    <option value="us_hist_bee">US History Bee</option>
                </select>
                <select class="history-filter" id="difficultyFilter">
                    <option value="all">All Difficulties</option>
                    <option value="P">Preliminary</option>
                    <option value="Q">Quarterfinals</option>
                    <option value="S">Semifinals</option>
                    <option value="F">Finals</option>
                </select>
                <select class="history-filter" id="statusFilter">
                    <option value="all">All Status</option>
                    <option value="correct">Correct</option>
                    <option value="incorrect">Incorrect</option>
                    <option value="skipped">Skipped</option>
                </select>
            </div>

            <div id="historyTableWrapper">
                <!-- Table will be generated by JS -->
            </div>

            <div class="dashboard-actions">
                <button class="btn-export" onclick="exportHistoryPage()">Export History (CSV)</button>
            </div>
        </div>
    </div>

    <!-- Profile Container -->
    <div id="profileContainer" class="dashboard-container">
        <div class="dashboard-header">
            <h1 class="dashboard-title">Profile</h1>
            <p class="dashboard-subtitle">Customize your profile and appear on the leaderboard</p>
        </div>

        <div class="dashboard-card">
            <div class="card-body">
                <div id="profileContent">
                    <!-- Not logged in message (hidden by default) -->
                    <div id="profileLoginMessage" class="leaderboard-empty" style="display: none;">
                        Please log in and verify your email to edit your profile
                    </div>

                    <!-- Profile form will be here -->
                    <div class="profile-form" id="profileFormContainer">
                        <!-- Rank Display -->
                        <div class="profile-section">
                            <label class="profile-label">Your Rank</label>
                            <div id="profileRankDisplay" style="margin-top: 10px;">
                                <!-- Shield and rank info will be generated by JS -->
                            </div>
                            <p class="profile-hint">Your rank is based on your total XP. Answer more questions to level up!</p>
                            <button class="btn-secondary" onclick="calculateRetroactivePoints()" style="width: 100%; margin-top: 10px;">Recalculate XP from History</button>
                        </div>

                        <!-- Username -->
                        <div class="profile-section">
                            <label class="profile-label" for="profileUsername">Username *</label>
                            <input type="text" id="profileUsername" class="profile-input" placeholder="Enter username (3-20 characters)" maxlength="20">
                            <div class="profile-hint">Alphanumeric and underscores only. Required to appear on leaderboard.</div>
                        </div>

                        <!-- First Name -->
                        <div class="profile-section">
                            <label class="profile-label" for="profileFirstName">First Name</label>
                            <input type="text" id="profileFirstName" class="profile-input" placeholder="Enter first name (optional)" maxlength="50">
                        </div>

                        <!-- Last Name -->
                        <div class="profile-section">
                            <label class="profile-label" for="profileLastName">Last Name</label>
                            <input type="text" id="profileLastName" class="profile-input" placeholder="Enter last name (optional)" maxlength="50">
                        </div>

                        <!-- State -->
                        <div class="profile-section">
                            <label class="profile-label" for="profileState">State/Location</label>
                            <select id="profileState" class="profile-input">
                                <option value="">Select a state (optional)</option>
                                <option value="AL">Alabama</option>
                                <option value="AK">Alaska</option>
                                <option value="AZ">Arizona</option>
                                <option value="AR">Arkansas</option>
                                <option value="CA">California</option>
                                <option value="CO">Colorado</option>
                                <option value="CT">Connecticut</option>
                                <option value="DE">Delaware</option>
                                <option value="FL">Florida</option>
                                <option value="GA">Georgia</option>
                                <option value="HI">Hawaii</option>
                                <option value="ID">Idaho</option>
                                <option value="IL">Illinois</option>
                                <option value="IN">Indiana</option>
                                <option value="IA">Iowa</option>
                                <option value="KS">Kansas</option>
                                <option value="KY">Kentucky</option>
                                <option value="LA">Louisiana</option>
                                <option value="ME">Maine</option>
                                <option value="MD">Maryland</option>
                                <option value="MA">Massachusetts</option>
                                <option value="MI">Michigan</option>
                                <option value="MN">Minnesota</option>
                                <option value="MS">Mississippi</option>
                                <option value="MO">Missouri</option>
                                <option value="MT">Montana</option>
                                <option value="NE">Nebraska</option>
                                <option value="NV">Nevada</option>
                                <option value="NH">New Hampshire</option>
                                <option value="NJ">New Jersey</option>
                                <option value="NM">New Mexico</option>
                                <option value="NY">New York</option>
                                <option value="NC">North Carolina</option>
                                <option value="ND">North Dakota</option>
                                <option value="OH">Ohio</option>
                                <option value="OK">Oklahoma</option>
                                <option value="OR">Oregon</option>
                                <option value="PA">Pennsylvania</option>
                                <option value="RI">Rhode Island</option>
                                <option value="SC">South Carolina</option>
                                <option value="SD">South Dakota</option>
                                <option value="TN">Tennessee</option>
                                <option value="TX">Texas</option>
                                <option value="UT">Utah</option>
                                <option value="VT">Vermont</option>
                                <option value="VA">Virginia</option>
                                <option value="WA">Washington</option>
                                <option value="WV">West Virginia</option>
                                <option value="WI">Wisconsin</option>
                                <option value="WY">Wyoming</option>
                                <option value="OTHER">Other/International</option>
                            </select>
                        </div>

                        <!-- School -->
                        <div class="profile-section">
                            <label class="profile-label" for="profileSchool">School</label>
                            <input type="text" id="profileSchool" class="profile-input" placeholder="Enter your school name (optional)" maxlength="100">
                        </div>

                        <!-- Save Button -->
                        <div class="profile-section">
                            <button class="btn-primary" onclick="saveProfile()" style="width: 100%; padding: 15px;">Save Profile</button>
                        </div>

                        <!-- Danger Zone -->
                        <div class="profile-section" style="margin-top: 40px; padding-top: 20px; border-top: 1px solid var(--border-color);">
                            <label class="profile-label" style="color: var(--error-red);">Danger Zone</label>
                            <p class="profile-hint" style="margin-bottom: 15px;">Permanently delete your account and all associated data. This action cannot be undone.</p>
                            <button class="btn-danger" onclick="deleteAccount()" style="width: 100%; padding: 15px;">Delete Account</button>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Leaderboard Container -->
    <div id="leaderboardContainer" class="dashboard-container">
        <div class="dashboard-header">
            <h1 class="dashboard-title">Leaderboard</h1>
            <p class="dashboard-subtitle">Compete with other players and climb the ranks</p>
        </div>

        <!-- Leaderboard Grid -->
        <div class="leaderboard-grid">
            <!-- All-Time Leaderboard -->
            <div class="dashboard-card">
                <div class="card-header">üèÜ All-Time Leaders</div>
                <div class="card-body">
                    <div id="leaderboardAllTime">
                        <!-- All-time leaderboard will be generated by JS -->
                    </div>
                </div>
            </div>

            <!-- Monthly Leaderboard -->
            <div class="dashboard-card">
                <div class="card-header">üìÖ This Month</div>
                <div class="card-body">
                    <div id="leaderboardMonthly">
                        <!-- Monthly leaderboard will be generated by JS -->
                    </div>
                </div>
            </div>

            <!-- Weekly Leaderboard -->
            <div class="dashboard-card">
                <div class="card-header">üìä This Week</div>
                <div class="card-body">
                    <div id="leaderboardWeekly">
                        <!-- Weekly leaderboard will be generated by JS -->
                    </div>
                </div>
            </div>

            <!-- Daily Leaderboard -->
            <div class="dashboard-card">
                <div class="card-header">‚ö° Today</div>
                <div class="card-body">
                    <div id="leaderboardDaily">
                        <!-- Daily leaderboard will be generated by JS -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for feedback -->
    <div id="feedbackModal" class="modal">
        <div class="modal-content">
            <h2 id="modalTitle">Result</h2>
            <p id="modalMessage"></p>
            <div class="modal-buttons" id="modalButtons"></div>
        </div>
    </div>

    <!-- Authentication Modal -->
    <div id="authModal" class="auth-modal">
        <div class="auth-modal-content">
            <div class="auth-modal-header">
                <h2 class="auth-modal-title">Welcome to HBReader</h2>
                <button class="auth-close" onclick="closeAuthModal()">&times;</button>
            </div>

            <div class="auth-tabs">
                <button class="auth-tab active" onclick="switchAuthTab('login')">Login</button>
                <button class="auth-tab" onclick="switchAuthTab('signup')">Sign Up</button>
            </div>

            <!-- Login Form -->
            <form id="loginForm" class="auth-form active" onsubmit="handleLogin(event)">
                <div class="auth-form-group">
                    <label for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" required>
                </div>
                <div class="auth-form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" required>
                </div>
                <div id="loginError" class="auth-error"></div>
                <button type="submit" class="auth-submit">Login</button>
                <div class="forgot-password-link">
                    <a href="#" onclick="handleForgotPassword(event)">Forgot your password?</a>
                </div>
            </form>

            <!-- Sign Up Form -->
            <form id="signupForm" class="auth-form" onsubmit="handleSignup(event)">
                <div class="auth-form-group">
                    <label for="signupEmail">Email</label>
                    <input type="email" id="signupEmail" required>
                </div>
                <div class="auth-form-group">
                    <label for="signupPassword">Password (min 6 characters)</label>
                    <input type="password" id="signupPassword" required minlength="6">
                </div>
                <div class="auth-form-group">
                    <label for="signupPasswordConfirm">Confirm Password</label>
                    <input type="password" id="signupPasswordConfirm" required minlength="6">
                </div>
                <div id="signupError" class="auth-error"></div>
                <button type="submit" class="auth-submit">Sign Up</button>
            </form>

            <!-- Social Login Section -->
            <div class="auth-divider">
                <span>or continue with</span>
            </div>

            <div class="social-login-buttons">
                <button type="button" class="social-login-btn google-btn" onclick="handleGoogleLogin()">
                    <svg width="18" height="18" viewBox="0 0 18 18">
                        <path fill="#4285F4" d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.874 2.684-6.615z"/>
                        <path fill="#34A853" d="M9 18c2.43 0 4.467-.806 5.956-2.184l-2.908-2.258c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332C2.438 15.983 5.482 18 9 18z"/>
                        <path fill="#FBBC05" d="M3.964 10.707c-.18-.54-.282-1.117-.282-1.707s.102-1.167.282-1.707V4.961H.957C.347 6.175 0 7.55 0 9s.348 2.825.957 4.039l3.007-2.332z"/>
                        <path fill="#EA4335" d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0 5.482 0 2.438 2.017.957 4.961L3.964 7.293C4.672 5.163 6.656 3.58 9 3.58z"/>
                    </svg>
                    Google
                </button>
            </div>
        </div>
    </div>


    <script type="module" src="src/js/main.js"></script>
</body>
</html>
